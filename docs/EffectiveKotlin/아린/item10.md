# 단위 테스트를 만들어라

1장은 안정성에 대한 내용이다

사실 코드를 안전하게 하는 가장 궁극적 방법은 테스트다

일반적으로는 사용자 관점에서 애플리케이션 외부가 제대로 작동하는지 확인하는 것을 목표로 하는데

이것만으로는 해당 요소가 올바르게 작동하는 것을 완전히 보증할 수 없고, 개발 시점에서 빠른 피드백을 받을 수 없다

개발자 관점에서 애플리케이션 내부를 확인하는데 집중해야 한다

이를 위해 단위 테스트(unit test)를 작성한다

단위 테스트는 개발자가 작성하고, 개발자에게 유용하다

## 단위 테스트에서의 확인

- 일반적인 유즈 케이스
    - 요소가 사용될 것이라 예상되는 일반적인 방법
    - ex) 함수로 간단한 숫자 테스트하기
- 일반적인 오류 케이스와 잠재적인 문제
    - 제대로 동작하지 않을 것이라 예상되는 부분
    - 이전에 문제였던 부분
- 에지 케이스와 잘못된 아규먼트
    - `Int` → Int.MAX_VALUE 사용하는 경우
    - `nullable` → null 또는 null 값으로 채워진 객체를 사용하는 경우
    - 아규먼트 자체를 잘못 넣을 경우

테스트는 계속 축적되므로 회귀 테스트를 하기도 좋다

수동으로 테스트하기 어려운 것들도 확인 가능하다

**TDD(Test Driven Development) 접근 방식**

: 개발 전에 테스트를 먼저 작성하고, 테스트 통과를 목표로 하나씩 구현하는 방법

## 단위 테스트 장점

- 테스트가 잘 된 신뢰적인 요소를 사용할 때 자신감이 생긴다
- 리팩토링 시 버그를 쉽게 확인할 수 있어 리팩토링에 두려움이 없어진다.
  테스트가 없으면 레거시 코드를 수정하는 것 자체가 두려워진다
- 수동으로 테스트하는 것보다 빠르다. 빠른 속도의 피드백 루프로 개발 속도가 빠르고 재밌어지며, 버그 수정 비용도 줄어든다

## 단위 테스트 단점

- 작성 자체에 시간이 오래 걸린다
    - 하지만 장기적으로 단위 테스트는 “디버깅 시간”, “버그 찾는 시간”을 줄여주므로 결론은 시간이 줄어든다고 봐야한다
- 테스트에 맞게 코드를 조정해야 한다
    - 하지만 이로써 잘 정립된 아키텍처를 사용할 수 밖에 없어진다
- 좋은 단위 테스트를 만들기 어렵고, 잘못된 단위 테스트는 득보다 실이 더 크다. 단위 테스트를 제대로 하는 방법을 올바르게 배워야하며, 소프트웨어 테스팅 및 TDD에 대한 내용을 이해해야 한다

## 단위 테스트 해야 하는 부분

- 복잡한 부분
- 계속 수정되고 리팩토링 될 수 있는 부분
- 비즈니스 로직
- 공용 API
- 문제가 자주 발생하는 부분
- 수정해야 하는 프로덕션 버그

# 1장을 마치며

일단 책 자체가 너무 맘에 든다!

책을 다 읽고 나면 이전보다 훨씬 좋은 코드를 작성할 수 있을 것이라는 예감이 든다.

이번장에서는 코틀린이 안전한 언어임을 뼈저리게 느꼈고, 이 안전한 언어를 정말 안전하게 작성하는 법에 대해 알 수 있었다

특히 예외 처리를 잘 해야 한다는 것에 대해서는 인지하고 있었지만 막 많이 신경쓰고 있지 않았던 것 같은데, 앞으로 더 신경써서 해야겠다

null 처리도 급하면 `!!` 쓰던가해서 처리했던 것 같은데 절대 지양하고, 최대한 nullable 타입을 쓰지 않도록,. 등등 코드 한 줄 한 줄 안정적으로 작성해서 다른 개발자들이 내 코드를 써도 안정적일 수 있게끔

책에서도 나왔지만 작성하는 것 자체가 어려운 테스트. 가 가장 궁극적으로 안정적인 방법이라니. 도전해보고 싶다!